(bacp) C:\Users\Fatim_Sproj\Desktop\Fatim\edge\Project\AI624-Diffusion-Quantization\sd35-qronos>python scripts/diag_03_timestep_accumulation.py                                                                                                 C:\Users\Fatim_Sproj\anaconda3\envs\bacp\lib\site-packages\torch\cuda\__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.                                                                   import pynvml  # type: ignore[import]                                                                                 2025-12-21 03:47:45.936806: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.                                                                   2025-12-21 03:47:46.589725: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.                                                                   ============================================================                                                            CROSS-TIMESTEP ERROR ACCUMULATION TEST                                                                                  ============================================================                                                                                                                                                                                    [1/4] Loading FP16 pipeline...                                                                                          Loading SD 3.5 Medium from stabilityai/stable-diffusion-3.5-medium...                                                   Loading pipeline components...:  33%|█████████████████▎                                  | 3/9 [00:00<00:00, 26.27it/s]You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers                                 Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  9.76it/s] Loading pipeline components...: 100%|████████████████████████████████████████████████████| 9/9 [00:02<00:00,  3.80it/s] Pipeline loaded successfully                                                                                              Transformer: 4.60 GB                                                                                                    Device: cuda:0                                                                                                                                                                                                                                [2/4] Running FP16 inference...                                                                                                                                                                                                                 [3/4] Quantizing model...                                                                                                                                                                                                                       [4/4] Running quantized inference...                                                                                                                                                                                                            ============================================================                                                            DIVERGENCE ANALYSIS                                                                                                     ============================================================                                                                                                                                                                                    Timestep   L2 Diff         Rel Diff        Max Diff                                                                     -------------------------------------------------------                                                                 0          0.000000        0.000000        0.000000                                                                     1          0.245465        0.000974        0.005859                                                                     2          0.564846        0.002271        0.012695                                                                     3          0.911462        0.003716        0.017578                                                                     4          1.288575        0.005333        0.021484                                                                     5          1.721553        0.007238        0.027344                                                                     6          2.214201        0.009467        0.034058                                                                     7          2.776119        0.012081        0.044067                                                                     8          3.400509        0.015078        0.055664                                                                     9          4.089543        0.018497        0.067383                                                                     10         4.845018        0.022379        0.080566                                                                     11         5.670908        0.026782        0.094360                                                                     12         6.578045        0.031802        0.108765                                                                     13         7.574507        0.037533        0.124023                                                                     14         8.678851        0.044126        0.140625                                                                     15         9.915648        0.051777        0.158203                                                                     16         11.306292       0.060670        0.176758                                                                     17         12.873939       0.070998        0.198730                                                                     18         14.655555       0.083005        0.227722                                                                     19         16.698082       0.096927        0.264709                                                                     20         19.067013       0.112995        0.310791                                                                     21         21.795610       0.131015        0.365845                                                                     22         24.996828       0.150890        0.431152                                                                     23         28.803785       0.172193        0.508545                                                                     24         33.425747       0.194372        0.611328                                                                     25         39.189644       0.217027        0.743164                                                                     26         46.554966       0.240088        0.905273                                                                     27         55.742760       0.262099        1.093750                                                                     28         56.270222       0.262229        1.104492                                                                                                                                                                                             Early timestep avg diff: 0.752587                                                                                       Late timestep avg diff: 46.236668                                                                                       Growth ratio: 61.44x                                                                                                                                                                                                                            ⚠️ EXPONENTIAL ERROR GROWTH DETECTED!                                                                                      This confirms cross-timestep error accumulation.                                                                                                                                                                                             Results saved to diagnosis_timesteps                                                                                                                                                                                                            (bacp) C:\Users\Fatim_Sproj\Desktop\Fatim\edge\Project\AI624-Diffusion-Quantization\sd35-qronos> 