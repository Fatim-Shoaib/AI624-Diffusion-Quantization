(bacp) C:\Users\Fatim_Sproj\Desktop\Fatim\edge\Project\AI624-Diffusion-Quantization\sd35-qronos>python scripts/diag_04_rtn_vs_gptq.py                                                                                                           C:\Users\Fatim_Sproj\anaconda3\envs\bacp\lib\site-packages\torch\cuda\__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.                                                                   import pynvml  # type: ignore[import]                                                                                 2025-12-21 03:49:18.585092: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.                                                                   2025-12-21 03:49:19.240834: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.                                                                   ============================================================                                                            RTN vs GPTQ COMPARISON                                                                                                  ============================================================                                                                                                                                                                                    [1/3] FP16 Baseline...                                                                                                  Loading SD 3.5 Medium from stabilityai/stable-diffusion-3.5-medium...                                                   Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 10.27it/s] Loading pipeline components...:  56%|████████████████████████████▉                       | 5/9 [00:01<00:01,  3.37it/s]You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers                                 Loading pipeline components...: 100%|████████████████████████████████████████████████████| 9/9 [00:02<00:00,  4.14it/s] Pipeline loaded successfully                                                                                              Transformer: 4.60 GB                                                                                                    Device: cuda:0                                                                                                        100%|██████████████████████████████████████████████████████████████████████████████████| 20/20 [00:01<00:00, 15.01it/s]   Image mean: 80.7                                                                                                                                                                                                                              [2/3] Simple RTN...                                                                                                     Loading SD 3.5 Medium from stabilityai/stable-diffusion-3.5-medium...                                                   Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 10.30it/s] Loading pipeline components...: 100%|████████████████████████████████████████████████████| 9/9 [00:02<00:00,  4.24it/s] Pipeline loaded successfully                                                                                              Transformer: 4.60 GB                                                                                                    Device: cuda:0                                                                                                          Quantized 215 layers                                                                                                  100%|██████████████████████████████████████████████████████████████████████████████████| 20/20 [00:01<00:00, 15.89it/s]   Image mean: 72.2                                                                                                                                                                                                                              [3/3] GPTQ-style with error diffusion...                                                                                Loading SD 3.5 Medium from stabilityai/stable-diffusion-3.5-medium...                                                   Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  9.74it/s] Loading pipeline components...: 100%|████████████████████████████████████████████████████| 9/9 [00:02<00:00,  3.75it/s] Pipeline loaded successfully                                                                                              Transformer: 4.60 GB                                                                                                    Device: cuda:0                                                                                                        Error on transformer_blocks.0.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                   Error on transformer_blocks.0.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                   Error on transformer_blocks.0.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                          Error on transformer_blocks.0.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                             Error on transformer_blocks.0.ff_context.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.1.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.1.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                   Error on transformer_blocks.1.attn.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                     Error on transformer_blocks.1.attn2.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                        Error on transformer_blocks.1.attn2.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.1.ff.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                     Error on transformer_blocks.1.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                          Error on transformer_blocks.1.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                             Error on transformer_blocks.2.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.2.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                   Error on transformer_blocks.2.attn.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                     Error on transformer_blocks.2.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                   Error on transformer_blocks.2.attn2.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                        Error on transformer_blocks.2.attn2.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.2.ff.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                     Error on transformer_blocks.2.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                          Error on transformer_blocks.2.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                             Error on transformer_blocks.2.ff_context.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.3.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.3.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                   Error on transformer_blocks.3.attn.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                     Error on transformer_blocks.3.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                   Error on transformer_blocks.3.attn2.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                        Error on transformer_blocks.3.ff.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                     Error on transformer_blocks.3.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                          Error on transformer_blocks.3.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                             Error on transformer_blocks.3.ff_context.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.4.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.4.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                   Error on transformer_blocks.4.attn.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                     Error on transformer_blocks.4.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                   Error on transformer_blocks.4.attn2.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                        Error on transformer_blocks.4.attn2.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.4.ff.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                     Error on transformer_blocks.4.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                          Error on transformer_blocks.4.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                             Error on transformer_blocks.4.ff_context.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.5.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.5.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                   Error on transformer_blocks.5.attn.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                     Error on transformer_blocks.5.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                   Error on transformer_blocks.5.attn2.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                        Error on transformer_blocks.5.attn2.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.5.ff.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                     Error on transformer_blocks.5.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                          Error on transformer_blocks.5.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                             Error on transformer_blocks.5.ff_context.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.6.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.6.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                   Error on transformer_blocks.6.attn.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                     Error on transformer_blocks.6.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                   Error on transformer_blocks.6.attn2.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                        Error on transformer_blocks.6.attn2.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.6.ff.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                     Error on transformer_blocks.6.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                          Error on transformer_blocks.6.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                             Error on transformer_blocks.6.ff_context.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.7.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.7.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                   Error on transformer_blocks.7.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                   Error on transformer_blocks.7.attn2.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                        Error on transformer_blocks.7.attn2.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.7.ff.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                     Error on transformer_blocks.7.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                          Error on transformer_blocks.7.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                             Error on transformer_blocks.7.ff_context.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.8.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.8.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                   Error on transformer_blocks.8.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                   Error on transformer_blocks.8.attn2.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.8.ff.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                     Error on transformer_blocks.8.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                          Error on transformer_blocks.8.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                             Error on transformer_blocks.8.ff_context.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.9.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.9.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                   Error on transformer_blocks.9.attn.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                     Error on transformer_blocks.9.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                   Error on transformer_blocks.9.attn2.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                        Error on transformer_blocks.9.attn2.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.9.ff.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                     Error on transformer_blocks.9.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                          Error on transformer_blocks.9.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                             Error on transformer_blocks.9.ff_context.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.10.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                        Error on transformer_blocks.10.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.10.attn.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.10.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.10.attn2.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                       Error on transformer_blocks.10.attn2.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                   Error on transformer_blocks.10.ff.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.10.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.10.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                            Error on transformer_blocks.10.ff_context.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                 Error on transformer_blocks.11.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                        Error on transformer_blocks.11.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.11.attn.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.11.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.11.attn2.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                       Error on transformer_blocks.11.ff.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.11.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.11.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                            Error on transformer_blocks.11.ff_context.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                 Error on transformer_blocks.12.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                        Error on transformer_blocks.12.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.12.attn.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.12.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.12.attn2.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                       Error on transformer_blocks.12.attn2.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                   Error on transformer_blocks.12.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.12.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                            Error on transformer_blocks.12.ff_context.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                 Error on transformer_blocks.13.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                        Error on transformer_blocks.13.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.13.attn.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.13.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.13.ff.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.13.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.13.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                            Error on transformer_blocks.13.ff_context.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                 Error on transformer_blocks.14.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                        Error on transformer_blocks.14.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.14.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.14.ff.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.14.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.14.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                            Error on transformer_blocks.14.ff_context.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                 Error on transformer_blocks.15.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                        Error on transformer_blocks.15.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.15.attn.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.15.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.15.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.15.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                            Error on transformer_blocks.15.ff_context.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                 Error on transformer_blocks.16.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                        Error on transformer_blocks.16.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.16.attn.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.16.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.16.ff.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.16.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.16.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                            Error on transformer_blocks.16.ff_context.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                 Error on transformer_blocks.17.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.17.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.17.ff.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.17.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.17.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                            Error on transformer_blocks.17.ff_context.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                 Error on transformer_blocks.18.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                        Error on transformer_blocks.18.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.18.attn.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.18.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.18.ff.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.18.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.18.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                            Error on transformer_blocks.18.ff_context.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                 Error on transformer_blocks.19.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                        Error on transformer_blocks.19.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.19.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.19.ff.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.19.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.19.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                            Error on transformer_blocks.19.ff_context.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                 Error on transformer_blocks.20.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                        Error on transformer_blocks.20.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.20.attn.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.20.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.20.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.20.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                            Error on transformer_blocks.21.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                        Error on transformer_blocks.21.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.21.attn.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.21.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.21.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.21.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                            Error on transformer_blocks.22.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                        Error on transformer_blocks.22.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.22.attn.to_add_out: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.22.ff.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.22.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Error on transformer_blocks.22.ff_context.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                            Error on transformer_blocks.23.attn.to_q: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                        Error on transformer_blocks.23.attn.add_q_proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                  Error on transformer_blocks.23.attn.to_out.0: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.23.ff.net.0.proj: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                    Error on transformer_blocks.23.ff.net.2: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!                                                                                                         Quantized: 0, Failed: 215                                                                                                 Quantized 0 layers                                                                                                    100%|██████████████████████████████████████████████████████████████████████████████████| 20/20 [00:01<00:00, 15.82it/s]   Image mean: 79.9                                                                                                                                                                                                                              ============================================================                                                            SUMMARY                                                                                                                 ============================================================                                                            FP16 baseline:  80.7                                                                                                    Simple RTN:     72.2                                                                                                    GPTQ-style:     79.9                                                                                                                                                                                                                            ✅ Both work → Current implementation is fine                                                                                                                                                                                                   Results saved to diagnosis_rtn_vs_gptq                                                                                                                                                                                                          (bacp) C:\Users\Fatim_Sproj\Desktop\Fatim\edge\Project\AI624-Diffusion-Quantization\sd35-qronos>