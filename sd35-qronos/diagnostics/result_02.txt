(bacp) C:\Users\Fatim_Sproj\Desktop\Fatim\edge\Project\AI624-Diffusion-Quantization\sd35-qronos>python scripts/diag_02_verify_hessian.py                                                                                                        C:\Users\Fatim_Sproj\anaconda3\envs\bacp\lib\site-packages\torch\cuda\__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.                                                                   import pynvml  # type: ignore[import]                                                                                 2025-12-21 03:45:06.594420: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.                                                                   2025-12-21 03:45:07.239805: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.                                                                   ============================================================                                                            HESSIAN MATRIX DIAGNOSTICS                                                                                              ============================================================                                                            ============================================================                                                            TEST: Incremental vs Batch H Computation                                                                                ============================================================                                                            Max difference: 7.15e-07                                                                                                Mean difference: 5.47e-09                                                                                               Relative error: 6.65e-07                                                                                                ✅ PASS: Incremental computation is correct                                                                                                                                                                                                     ============================================================                                                            TEST: H Matrix Properties                                                                                               ============================================================                                                            Checking H matrices: 100%|█████████████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.36it/s] ❌ Found 9 issues:                                                                                                        - time_text_embed.text_embedder.linear_1: Negative eigenvalue (-7.23e-05)                                               - time_text_embed.text_embedder.linear_2: Negative eigenvalue (-3.09e-05)                                               - context_embedder: Negative eigenvalue (-8.30e-05)                                                                     - transformer_blocks.0.attn.to_out.0: Negative eigenvalue (-2.49e-05)                                                   - transformer_blocks.0.attn2.to_q: Negative eigenvalue (-4.21e-05)                                                      - transformer_blocks.0.attn2.to_k: Negative eigenvalue (-4.21e-05)                                                      - transformer_blocks.0.attn2.to_v: Negative eigenvalue (-4.21e-05)                                                      - transformer_blocks.0.attn2.to_out.0: Not symmetric (error=9.65e+12)                                                   - transformer_blocks.0.attn2.to_out.0: Negative eigenvalue (-1.37e+13)                                                                                                                                                                        ============================================================                                                            TEST: H Matrix Invertibility                                                                                            ============================================================                                                            Testing invertibility: 100%|█████████████████████████████████████████████████████████| 391/391 [00:20<00:00, 18.98it/s] Invertible: 354/391                                                                                                     Not invertible: 37/391                                                                                                  ⚠️ WARNING: Many H matrices are not invertible                                                                                                                                                                                                  ============================================================                                                            SUMMARY                                                                                                                 ============================================================                                                              incremental_correct: ✅ PASS                                                                                            h_properties_ok: ❌ FAIL                                                                                                h_invertible: ❌ FAIL                                                                                                                                                                                                                         (bacp) C:\Users\Fatim_Sproj\Desktop\Fatim\edge\Project\AI624-Diffusion-Quantization\sd35-qronos> 